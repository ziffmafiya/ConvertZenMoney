# Деплой на Render

## Подготовка к деплою

### 1. Подготовка репозитория

Убедитесь, что ваш проект находится в Git репозитории:

```bash
git init
git add .
git commit -m "Initial commit for Render deployment"
```

### 2. Создание аккаунта на Render

1. Перейдите на [render.com](https://render.com)
2. Зарегистрируйтесь или войдите в аккаунт
3. Подключите ваш GitHub/GitLab репозиторий

### 3. Создание нового Web Service

1. В панели Render нажмите "New +"
2. Выберите "Web Service"
3. Подключите ваш репозиторий
4. Настройте следующие параметры:

**Основные настройки:**
- **Name**: `finance-analyzer` (или любое другое имя)
- **Environment**: `Node`
- **Region**: Выберите ближайший к вам регион
- **Branch**: `main` (или ваша основная ветка)
- **Build Command**: `npm install`
- **Start Command**: `npm start`

### 4. Настройка переменных окружения

В разделе "Environment Variables" добавьте следующие переменные:

```
NODE_ENV=production
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
GOOGLE_AI_API_KEY=your_google_ai_api_key
ASPOSE_OCR_API_KEY=your_aspose_ocr_api_key
```

**Где взять эти ключи:**

- **SUPABASE_URL и SUPABASE_ANON_KEY**: В панели Supabase → Settings → API
- **GOOGLE_AI_API_KEY**: В Google AI Studio → API Keys
- **ASPOSE_OCR_API_KEY**: В Aspose Cloud Dashboard

### 5. Деплой

1. Нажмите "Create Web Service"
2. Render автоматически начнет процесс деплоя
3. Дождитесь завершения сборки (обычно 2-5 минут)

### 6. Проверка работы

После успешного деплоя:

1. Перейдите по ссылке, которую предоставит Render
2. Проверьте, что приложение загружается корректно
3. Протестируйте основные функции

## Структура файлов для деплоя

```
├── server.js              # Основной серверный файл
├── package.json           # Зависимости и скрипты
├── render.yaml            # Конфигурация Render (опционально)
├── index.html             # Главная страница
├── api/                   # API роуты
│   ├── get-transactions.js
│   ├── upload-transactions.js
│   └── ...
└── .gitignore            # Исключения для Git
```

## Возможные проблемы и решения

### 1. Ошибка "Module not found"

**Проблема**: Приложение не может найти модули
**Решение**: Убедитесь, что все зависимости указаны в `package.json`

### 2. Ошибка "Port already in use"

**Проблема**: Приложение не может запуститься на указанном порту
**Решение**: Render автоматически предоставляет переменную `PORT`, используйте её

### 3. Ошибки с переменными окружения

**Проблема**: API ключи не работают
**Решение**: 
- Проверьте правильность ключей в настройках Render
- Убедитесь, что ключи не содержат лишних пробелов
- Перезапустите сервис после изменения переменных

### 4. Медленная загрузка

**Проблема**: Приложение загружается медленно
**Решение**: 
- Используйте CDN для статических ресурсов
- Оптимизируйте размер изображений
- Рассмотрите возможность использования кэширования

## Обновление приложения

Для обновления приложения:

1. Внесите изменения в код
2. Закоммитьте изменения:
   ```bash
   git add .
   git commit -m "Update application"
   git push origin main
   ```
3. Render автоматически обнаружит изменения и перезапустит деплой

## Мониторинг

В панели Render вы можете:

- Просматривать логи приложения
- Мониторить производительность
- Настраивать автоматические деплои
- Управлять переменными окружения

## Поддержка

Если возникли проблемы:

1. Проверьте логи в панели Render
2. Убедитесь, что все переменные окружения настроены правильно
3. Проверьте, что приложение работает локально
4. Обратитесь в поддержку Render при необходимости 