<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- ... (head без изменений) ... -->
</head>
<body class="antialiased bg-[#0D1117] text-[#c9d1d9]">

    <!-- ... (существующая верстка) ... -->

    <!-- Секция графика "Траты vs. Доходы" -->
    <section id="spendIncomeTrendSection" class="bg-[#161b22] rounded-2xl p-6 text-left transition-all duration-300 border border-[#30363d] hover:translate-y-[-5px] hover:shadow-lg hover:shadow-black/30 hover:border-[#8b5cf6] mb-8 md:mb-12">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-semibold text-gray-300">Траты vs. Доходы</h3>
            <button id="toggleSpendIncomeVisibility" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                Скрыть/Показать
            </button>
        </div>
        <div id="spendIncomeContent">
            <div class="h-96">
                <canvas id="spendIncomeTrendChart"></canvas>
            </div>
            <!-- Добавлен блок для средних значений -->
            <div class="flex justify-between mt-4 text-center">
                <div class="w-1/2">
                    <p class="text-gray-400">Среднедневной доход</p>
                    <p id="averageIncomePerDay" class="text-xl font-bold text-green-400">0 грн</p>
                </div>
                <div class="w-1/2">
                    <p class="text-gray-400">Среднедневная трата</p>
                    <p id="averageExpensePerDay" class="text-xl font-bold text-red-400">0 грн</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ... (остальная верстка) ... -->

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // ... (существующий код) ...

            // В функцию analyzeAndRender добавляем расчет средних значений
            function analyzeAndRender(transactions) {
                // ... (существующий код) ...
                
                // Рассчитываем средние значения
                let totalDays = Object.keys(dailyData).length;
                let totalIncome = 0;
                let totalExpenses = 0;
                
                for (const date in dailyData) {
                    totalIncome += dailyData[date].income;
                    totalExpenses += dailyData[date].expenses;
                }
                
                const averageIncomePerDay = totalDays > 0 ? totalIncome / totalDays : 0;
                const averageExpensePerDay = totalDays > 0 ? totalExpenses / totalDays : 0;
                
                // Обновляем элементы
                document.getElementById('averageIncomePerDay').textContent = 
                    averageIncomePerDay.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + ' грн';
                
                document.getElementById('averageExpensePerDay').textContent = 
                    averageExpensePerDay.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + ' грн';

                // ... (остальной код) ...
            }

            // ... (остальной код) ...
        });
    </script>
</body>
</html>
