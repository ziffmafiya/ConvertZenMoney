# Финансовый Анализатор

Веб-приложение для анализа финансовых привычек, отслеживания транзакций, управления целями и кредитами.

## Основные функции

### 📊 Анализ транзакций
- Загрузка и анализ банковских выписок
- Группировка транзакций по категориям
- Визуализация расходов и доходов
- Детекция аномалий в расходах

### 🎯 Управление целями
- Создание финансовых целей
- Отслеживание прогресса
- Автоматические рекомендации

### 💳 Управление кредитами
- Добавление кредитов с названиями
- Автоматический расчет ежемесячного платежа
- Отслеживание выплаченной суммы и остатка
- Запись платежей по кредитам
- Удаление кредитов
- Визуализация прогресса погашения

### 💳 Управление кредитными картами
- Добавление кредитных карт с датой первой операции
- Умное отслеживание льготного периода
- Удаление кредитных карт
- Мониторинг статуса платежей

## Кредиты

### Поля кредита
- **Название кредита** (loan_name) - опциональное поле
- **Основная сумма** (principal) - обязательное поле
- **Процентная ставка** (interest_rate) - обязательное поле  
- **Срок в месяцах** (term_months) - обязательное поле
- **Дата открытия** (start_date) - обязательное поле
- **Уже выплачено** (paid_amount) - опциональное поле, по умолчанию 0
- **Ежемесячный платеж** (monthly_payment) - рассчитывается автоматически
- **Остаток** (remaining_balance) - рассчитывается автоматически

### Отображаемая информация
- Название кредита (или автоматически сгенерированное)
- Основная сумма и процентная ставка
- Срок кредита и ежемесячный платеж
- Сумма уже выплаченная и остаток
- Прогресс погашения в процентах
- Оставшееся количество месяцев
- Визуальный прогресс-бар

### API endpoints для кредитов
- `GET /api/loans` - получение всех кредитов
- `POST /api/loans` - добавление нового кредита
- `PUT /api/loans` - обновление кредита
- `PATCH /api/loans` - запись платежа по кредиту
- `DELETE /api/loans?id={id}` - удаление кредита

## Кредитные карты

### Поля кредитной карты
- **Название карты** (card_name) - обязательное поле
- **Льготный период** (grace_period_days) - обязательное поле
- **День выписки** (statement_day) - опциональное поле (1-31)
- **День платежа** (payment_due_day) - опциональное поле (1-31)
- **Дата первой операции** (first_transaction_date) - опциональное поле
- **Текущая задолженность** (unpaid_balance) - опциональное поле

### Логика льготного периода
Система реализует правильную логику расчета льготного периода:

1. **Расчетный период**: Календарный месяц с момента первой операции
2. **Льготный период**: До конца следующего месяца после расчетного периода
3. **Пример**: Если первая операция была 6 сентября, то льготный период действует до 31 октября

### Отображаемая информация
- Название карты и льготный период
- Дата первой операции (если указана)
- Дни выписки и платежа (если указаны)
- Текущая задолженность
- Статус льготного периода (активен/истек/последний день)
- Количество дней до платежа

### API endpoints для кредитных карт
- `GET /api/credit-cards` - получение всех кредитных карт
- `POST /api/credit-cards` - добавление новой кредитной карты
- `PUT /api/credit-cards` - обновление кредитной карты
- `DELETE /api/credit-cards?id={id}` - удаление кредитной карты

## Технологии

- **Frontend**: HTML5, CSS3 (Tailwind CSS), JavaScript (ES6+)
- **Backend**: Vercel Functions (Node.js)
- **База данных**: Supabase (PostgreSQL)
- **Визуализация**: Chart.js
- **Интернационализация**: i18next

## Структура базы данных

### Таблица loans
```sql
CREATE TABLE public.loans (
    id SERIAL PRIMARY KEY,
    loan_name VARCHAR(255),
    principal NUMERIC(15, 2) NOT NULL,
    interest_rate NUMERIC(5, 2) NOT NULL,
    term_months INTEGER NOT NULL,
    start_date DATE NOT NULL,
    monthly_payment NUMERIC(15, 2) NOT NULL,
    remaining_balance NUMERIC(15, 2) NOT NULL,
    paid_amount NUMERIC(15, 2) NOT NULL DEFAULT 0.00,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### Таблица credit_cards
```sql
CREATE TABLE public.credit_cards (
    id SERIAL PRIMARY KEY,
    card_name VARCHAR(255) NOT NULL,
    grace_period_days INTEGER NOT NULL,
    statement_day INTEGER CHECK (statement_day >= 1 AND statement_day <= 31),
    payment_due_day INTEGER CHECK (payment_due_day >= 1 AND payment_due_day <= 31),
    first_transaction_date DATE,
    unpaid_balance NUMERIC(15, 2) DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);
```

## Использование

1. **Добавление кредита**:
   - Нажмите "Добавить кредит"
   - Заполните название кредита (опционально)
   - Заполните основную сумму, процентную ставку, срок и дату открытия
   - При желании укажите уже выплаченную сумму
   - Ежемесячный платеж рассчитывается автоматически

2. **Запись платежа по кредиту**:
   - Введите сумму платежа в поле рядом с кредитом
   - Нажмите "Записать платеж"
   - Система автоматически обновит выплаченную сумму и остаток

3. **Удаление кредита**:
   - Нажмите "Удалить" рядом с кредитом
   - Подтвердите удаление

4. **Добавление кредитной карты**:
   - Нажмите "Добавить кредитную карту"
   - Заполните название карты и льготный период
   - При желании укажите дату первой операции для правильного расчета льготного периода
   - При желании укажите дни выписки и платежа

5. **Удаление кредитной карты**:
   - Нажмите "Удалить" рядом с кредитной картой
   - Подтвердите удаление

## Особенности

- **Автоматический расчет**: Ежемесячный платеж рассчитывается по формуле аннуитетного платежа
- **Умное отслеживание**: Система автоматически отслеживает прогресс погашения и статус льготного периода
- **Правильная логика льготного периода**: Реализована корректная механика расчета льготного периода на основе даты первой операции
- **Визуализация**: Прогресс-бары и цветовая индикация для лучшего восприятия
- **Безопасность**: Подтверждение перед удалением записей
